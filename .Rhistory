s[,-"X"]
s[-c("X")]
s[-c(X)]
class(s)
s$X
s
subset(s,select=-c("X"))
subset(s,select=c("X")
)
subset(s,select= -c("X"))
subset(s,select= -"X")
subset(s,select= -X)
s = subset(s,select= -X)
head(s)
head(karyotype_dual_comparison)
karyotype_dual_comparison = data.frame(Chr=c(to,to),Start=1)
karyotype_dual_comparison
karyotype_dual_comparison = data.frame(Chr=c(to,to),Start=1,End=c(human_lengths,zebra_lengths),species=NA,size=12,color=252525)
karyotype_dual_comparison
karyotype_dual_comparison[1:22,"species"] = "Human"
karyotype_dual_comparison[23:44,"species"] = "Zebrafish"
ideogram(karyotype = karyotype_dual_comparison, synteny = synteny_dual_comparison)
ideogram(karyotype = karyotype_dual_comparison, synteny = s)
s
nrow(s)
karyotype_dual_comparison
tail(s)
ideogram(karyotype = karyotype_dual_comparison, synteny = s)
convertSVG("chromosome.svg", device = "png")
ncol(s)
ncol(karyotype_dual_comparison)
head(karyotype_dual_comparison)
nrow(karyotype_dual_comparison)
names(karyotype_dual_comparison)
ncol(karyotype_dual_comparison)
names(s)
nrow(karyotype_dual_comparison)
write.csv(karyotype_dual_comparison,'karyotype_dual_comparison.txt',row.names=FALSE)
write.csv(s,'syntheny.txt',row.names=FALSE)
synteny_dual_comparison = read.table('syntheny.txt',sep=",",header=T,stringsAsFactors=F)
karyotype_dual_comparison = read.table('karyotype_dual_comparison.txt',sep=",",header=T,stringsAsFactors = F)
head(karyotype_dual_comparison)
head(syntenty_dual_comparison)
ideogram(karyotype = karyotype_dual_comparison, synteny = synteny_dual_comparison)
convertSVG("chromosome.svg", device = "png")
head(synteny_dual_comparison)
class(synteny_dual_comparison)
s = synteny_dual_comparison
s = tibble(s)
library(tidyverse)
s = tibble(s)
s %>%
filter(human_chr %in% seq(1,22))
s %>%
filter(human_chr %in% human_chroms)
s
s %>%
filter(Species_1 %in% seq(1,22))
s = s %>%
filter(Species_1 %in% seq(1,22))
nrow(s)
s = s %>%
filter(Species_2 %in% seq(1,22))
nrow(s)
ideogram(karyotype = karyotype_dual_comparison, synteny = s)
convertSVG("chromosome.svg", device = "png")
unique(s$Species_1)
head(karyotype_dual_comparison)
karyotype_dual_comparison
head(s)
s = as.data.frame(s)
s
tail(s)
is.na(s)
is.na(s) == TRUE
S[,is.na(s) == TRUE]
s[,is.na(s) == TRUE]
s[,!is.na(s) == TRUE]
names(which(colSums(is.na(s)) > 0))
s
dim(s)
s
ideogram(karyotype = karyotype_dual_comparison,synteny = s)
which(is.na(s))
which(is.na(karyotype_dual_comparison))
nrow(karyotype_dual_comparison)
ncol(karyotype_dual_comparison)
head(karyotype_dual_comparison)
karyotype_dual_comparison$fill = 969696
ideogram(karyotype = karyotype_dual_comparison,synteny = s)
karyotype_dual_comparison
karyotype_dual_comparison[,c(1,2,3,7,4,5,6)]
k = karyotype_dual_comparison[,c(1,2,3,7,4,5,6)]
ideogram(karyotype = k,synteny = s)
write.csv(k, 'karyotype_dual_comparison.txt',row.names=FALSE)
karyotype_dual_comparison = read.table('karyotype_dual_comparison.txt',sep=",",header=T,stringsAsFactors = F)
head(karyotype_dual_comparison)
ideogram(karyotype = k,synteny = s)
s
write.csv(s,'syntheny.txt',row.names=FALSE)
k = read.table('syntheny.txt',sep=",",header=T,stringsAsFactors = F)
ideogram(karyotype = k,synteny = s)
s
k
table(k$species)
head(k)
s
k
karyotype_dual_comparison
s
synteny_dual_comparison = s
ideogram(karyotype = karyotype_dual_comparison,synteny = syntenty_dual_comparison)
karyotype_dual_comparison
ideogram(karyotype = karyotype_dual_comparison,synteny = synteny_dual_comparison)
class(karyotype_dual_comparison$Start)
class(karyotype_dual_comparison$End)
class(karyotype_dual_comparison$fill)
class(karyotype_dual_comparison$size)
class(karyotype_dual_comparison$fill)
synteny_dual_comparison
class(syntenty_dual_comparison$Species_1)
rm(sntenty_dual_comparison)
rm(syntenty_dual_comparison)
class(synteny_dual_comparison$Species_1)
synteny_dual_comparison$Species_1 = as.numeric(synteny_dual_comparison$Species_1)
synteny_dual_comparison$Species_2 = as.numeric(synteny_dual_comparison$Species_2)
class(synteny_dual_comparison$Species_1)
synteny_dual_comparison$Start_1 = as.numeric(synteny_dual_comparison$Start_1)
synteny_dual_comparison$Start_2 = as.numeric(synteny_dual_comparison$Start_2)
head(synteny_dual_comparison)
synteny_dual_comparison$End_2 = as.numeric(synteny_dual_comparison$End_2)
synteny_dual_comparison$End_1 = as.numeric(synteny_dual_comparison$End_1)
ideogram(karyotype = karyotype_dual_comparison,synteny = synteny_dual_comparison)
convertSVG("chromosome.svg", device = "png")
head(karyotype_dual_comparison)
karyotype_dual_comparison[6,'fill'] = '0ab276'
head(karyotype_dual_comparison)
ideogram(karyotype = karyotype_dual_comparison,synteny = synteny_dual_comparison)
convertSVG("chromosome.svg", device = "png")
synteny_dual_comparison$Species_1 == 6
synteny_dual_comparison[synteny_dual_comparison$Species_1 == 6,"fill"]
synteny_dual_comparison[synteny_dual_comparison$Species_1 == 6,"fill"] = '0ab276'
synteny_dual_comparison[synteny_dual_comparison$Species_1 == 6,"fill"]
ideogram(karyotype = karyotype_dual_comparison,synteny = synteny_dual_comparison)
convertSVG("chromosome.svg", device = "png")
karyotype_dual_comparison[2,'fill'] = '8a2be2'
head(karyotype_dual_comparison)
synteny_dual_comparison[synteny_dual_comparison$Species_1 == 2,"fill"] = '8a2be2'
ideogram(karyotype = karyotype_dual_comparison,synteny = synteny_dual_comparison)
convertSVG("chromosome.svg", device = "png")
synteny_dual_comparison[synteny_dual_comparison$Species_2 == 4,"fill"] = 'ff0080'
karyotype_dual_comparison[26,'fill'] = '8a2be2'
karyotype_dual_comparison[26,'fill'] = 'ff0080'
ideogram(karyotype = karyotype_dual_comparison,synteny = synteny_dual_comparison)
convertSVG("chromosome.svg", device = "png")
synteny_dual_comparison[synteny_dual_comparison$Species_2 == 9,"fill"] = 'ff8000'
karyotype_dual_comparison[31,'fill'] = 'ff8000'
ideogram(karyotype = karyotype_dual_comparison,synteny = synteny_dual_comparison)
convertSVG("chromosome.svg", device = "png")
arrange(synteny_dual_comparison,by='fill')
synteny_dual_comparison %>%
arrange(fill)
synteny_dual_comparison %>%
arrange(fill)
synteny_dual_comparison = synteny_dual_comparison %>%
arrange(fill)
ideogram(karyotype = karyotype_dual_comparison,synteny = synteny_dual_comparison)
convertSVG("chromosome.svg", device = "png")
unique(synteny_dual_comparison$fill)
table(synteny_dual_comparison$fill)
col_levels = c('cccccc','ff0080','ff8000','0ab276','8a2be2')
synteny_dual_comparison = synteny_dual_comparison %>%
arrange(fill,levels=col_levels)
synteny_dual_comparison = synteny_dual_comparison %>%
arrange(factor(fill,levels=col_levels))
ideogram(karyotype = karyotype_dual_comparison,synteny = synteny_dual_comparison)
convertSVG("chromosome.svg", device = "png")
karyotype_dual_comparison[6,'fill'] = 'cccccc'
synteny_dual_comparison[synteny_dual_comparison$Species_1 == 6,"fill"] = 'cccccc'
ideogram(karyotype = karyotype_dual_comparison,synteny = synteny_dual_comparison)
convertSVG("chromosome.svg", device = "png")
synteny_dual_comparison = synteny_dual_comparison %>%
arrange(factor(fill,levels=col_levels))
ideogram(karyotype = karyotype_dual_comparison,synteny = synteny_dual_comparison)
convertSVG("chromosome.svg", device = "png")
synteny_dual_comparison[synteny_dual_comparison$Species_1 == 2,"fill"] = 'cccccc'
head(karyotype_dual_comparison)
karyotype_dual_comparison[6,'fill'] = '969696'
karyotype_dual_comparison[2,'fill'] = '969696'
synteny_dual_comparison[synteny_dual_comparison$Species_12 == 12,"fill"] = '40ff00'
table(karyotype_dual_comparison$fill)
table(synteny_dual_comparison$fill)
synteny_dual_comparison[synteny_dual_comparison$Species_2 == 12,"fill"] = '40ff00'
table(synteny_dual_comparison$fill)
col_levels = c('cccccc','ff8000','ff0080','40ff00')
karyotype_dual_comparison[34,'fill'] = '40ff00'
synteny_dual_comparison = synteny_dual_comparison %>%
arrange(factor(fill,levels=col_levels))
ideogram(karyotype = karyotype_dual_comparison,synteny = synteny_dual_comparison)
convertSVG("chromosome.svg", device = "png")
ls
table(master_df$human_chr)
table(master_df$zebra_chr)
ls
table(master_df$human_chr)
table(master_df$zebra_chr)
head(karyotype_dual_comparison)
zebra_chrom_lengths = tibble(chr=zebra_chroms)
library(tidyverse)
zebra_chrom_lengths = tibble(chr=zebra_chroms)
zebra_chrom_lengths
zebra_chrom_lengths$length = zebra_lengths
zebra_lengths = c(zebra_chrom_lengths,seq(1,6))
zebra_lengths
zebra_lengths = c(zebra_chrom_lengths,0,0,0,0,0,0)
zebra_chrom_lengths$length = zebra_lengths
zebra_chrom_lengths
zebra_lengths
zebra_lengths = seq(1,25)
zebra_chroms
zebra_chrom_lengths
human_chrom_lengths = tibble(chr=human_chroms)
human_chrom_lengths
len(human_lengths)
human_lengths
h = c(human_lengths,10)
h
h = c(human_lengths,0,0)
human_chrom_lengths$length = h
h = c(human_lengths,0,0,0)
human_chrom_lengths$length = h
human_chrom_lengths
tail(human_chrom_lengths)
human_chrom_lengths$chr
human_chrom_lengths$chr == 'X'
human_chrom_lengths[human_chrom_lengths$chr == 'X','length'] = 156040895
human_chrom_lengths[human_chrom_lengths$chr == 'Y','length'] = 57227415
zebra_chrom_lengths
zebra_lengths = c(59578282,59640629,62628489,78093715,72500376,60270059,74282399,54304671,56459846,45420867,45484837,49182954,52186027,52660232,48040578,55266484,53461100,51023478,48449771,55201332,45934066,39133080,46223584,42172926,37502051)
zebra_lengths
zebra_chrom_lengths
zebra_chrom_lengths$chr
zebra_chrom_lengths$length = zebra_lengths
z = c(zebra_lengths,0,0,0)
zebra_chrom_lengths$length = z
head(human_karyotype)
head(karyotype_dual_comparison)
from
mapvalues(karyotype_dual_comparison$Chr,from=to,to=from)
require(plyr)
mapvalues(karyotype_dual_comparison$Chr,from=to,to=from)
karyotype_dual_comparison$Chr = mapvlaues(karyotype_dual_comparison$Chr,from=to,to=from)
karyotype_dual_comparison$Chr = mapvalues(karyotype_dual_comparison$Chr,from=to,to=from)
table(karyotype_dual_comparison$Chr)
head(karyotype_dual_comparison)
ideogram(karyotype = karyotype_dual_comparison,synteny = synteny_dual_comparison)
require(RIdeogram)
ideogram(karyotype = karyotype_dual_comparison,synteny = synteny_dual_comparison)
convertSVG("testing.svg", device = "png")
convertSVG("chromosome.svg", device = "png")
head(karyotype_dual_comparison)
head(synteny_dual_comparison)
new_synteny = tibble(Species_1=master_df$human_chr,Start_1=master_df$human_gene_start,End_1=master_df$human_gene_end,Species_2=master_df$zebra_chr,Start_2=master_df$zebra_gene_start,End_2=master_df$zebra_gene_end,fill='cccccc')
head(new_synteny)
table(new_synteny$Species_1)
ideogram(karyotype = karyotype_dual_comparison,synteny = new_synteny)
new_synteny
new_synteny = tibble(new_synteny)
ideogram(karyotype = karyotype_dual_comparison,synteny = new_synteny)
head(new_synteny)
class(new_synteny)
write.csv(new_synteny,'syntheny.txt',row.names=FALSE)
synteny = read.table('syntheny.txt',sep=",",header=T,stringsAsFactors=F)
head(synteny)
ideogram(karyotype = karyotype_dual_comparison,synteny = synteny)
str(synteny)
synteny$Start_1 = as.numeric(synteny$Start_1)
str(synteny)
synteny$Start_2 = as.numeric(synteny$Start_2)
synteny$End_2 = as.numeric(synteny$End_2)
str(synteny)
str(karyotype_dual_comparison)
head(karyotype_dual_comparison)
ideogram(karyotype = karyotype_dual_comparison,synteny = synteny)
ncol(karyotype_dual_comparison)
ncol(synteny)
head(synteny)
str(synteny)
synteny_no_chr = synteny
head(synteny_no_chr)
is.numeric(synteny_no_chr$Species_1)
table(synteny_no_chr$Species_1)
synteny_no_chr[synteny_no_chr$Species_1 != 'MT',]
synteny_no_chr = synteny_no_chr[synteny_no_chr$Species_1 != 'MT',]
nrow(synteny_no_chr)
synteny_no_chr = synteny_no_chr[synteny_no_chr$Species_1 != 'X',]
head(synteny_no_chr)
str(synteny_no_chr)
synteny_no_chr = synteny_no_chr[synteny_no_chr$Species_2 != 'X',]
table(synteny_no_chr$Species_2)
synteny_no_chr$Species_1 = as.numeric(synteny_no_chr$Species_1)
synteny_no_chr$Species_2 = as.numeric(synteny_no_chr$Species_2)
str(synteny_no_chr)
ideogram(karyotype = karyotype_dual_comparison,synteny = synteny_no_chr)
head(synteny_no_chr)
synteny_no_chr$Species_1 = as.character(synteny_no_chr$Species_1)
str(synteny_no_chr)
ideogram(karyotype = karyotype_dual_comparison,synteny = synteny_no_chr)
synteny_no_chr$Species_1 = as.numeric(synteny_no_chr$Species_1)
str(synteny_no_chr)
ideogram(karyotype = karyotype_dual_comparison,synteny = synteny_no_chr)
table(synteny_no_chr$Species_1)
table(synteny_no_chr$Species_2)
karyotype_dual_comparison
new_karyotype = data.frame(Chr=c(zebra_chrom_lengths$chr,human_chrom_lengths$chr))
head(new_karyotype)
new_karyotype
new_karyotype = new_karyotype[new_karyotype$Chr != 'X',]
new_karyotype = new_karyotype[new_karyotype$Chr != 'Y',]
new_karyotype
new_karyotype = data.frame(Chr=c(zebra_chrom_lengths$chr,human_chrom_lengths$chr))
head(new_karyotype)
new_karyotype = data.frame(Chr=c(human_chrom_lengths$chr,zebra_chrom_lengths$chr),Start=1,End=c(human_chrom_lengths$length,zebra_chrom_lengths$length))
head(new_karyotype)
new_karyotype = new_karyotype[new_karyotype$Chr != 'X',]
new_karyotype = new_karyotype[new_karyotype$Chr != 'Y',]
new_karyotype = new_karyotype[new_karyotype$Chr != 'MT',]
new_karyotype
new_karyotype$species = 'Human'
new_karyotype$species[26:50,'species'] = 'Zebrafish'
new_karyotype
row.names(new_karyotype) <- NULL
new_karyotype
new_karyotype$species[23:47,'species'] = 'Zebrafish'
new_karyotype[23:47,'species'] = 'Zebrafish'
new_karyotype
new_karyotype$size = 12
new_karyotype$color = '252525'
str(new_karyotype)
head(new_karyotype)
new_karyotype$fill = '969696'
new_karyotype
new_karyotype[,c(1,2,3,7,4,5,6)]
new_karyotype = new_karyotype[,c(1,2,3,7,4,5,6)]
new_karyotype
str(new_karyotype)
ideogram(karyotype = new_karyotype,synteny = synteny_no_chr)
head(synteny_no_chr)
View(new_karyotype)
synteny_no_chr
is.na(new_synteny)
is.na(new_synteny) == TRUE
rowSums(is.na(new_synteny))
new_synteny[is.na(new_synteny),]
new_synteny[rowSums(is.na(new_synteny)) == 1,]
new_synteny = new_synteny[rowSums(is.na(new_synteny)) == 0,]
nrow(new_synteny)
ideogram(karyotype = new_karyotype,synteny = synteny_no_chr)
ideogram(karyotype = new_karyotype,synteny = new_synteny)
rowSums(is.na(synteny_no_chr))
nrow(synteny_no_chr)
head(synteny_no_chr)
table(new_synteny$Species_1)
nrow(new_synteny)
nrow(synteny_no_chr)
str(synteny_no_chr)
synteny_no_chr = synteny_no_chr[rowSums(is.na(synteny_no_chr) == 0),]
nrow(synteny_no_chr)
ideogram(karyotype = new_karyotype,synteny = synteny_no_chr)
convertSVG("chromosome.svg", device = "png")
is.na(master_df)
rowSums(is.na(master_df))
master_df[rowSums(is.na(master_df)) == 1,]
head(synteny_no_chr)
nrow(synteny_no_chr)
row.names(synteny_no_chr) <- NULL
head(synteny_no_chr)
head(karyotype_dual_comparison)
head(new_karyotype)
nrow(new_karyotype)
ideogram(karyotype = new_karyotype,synteny = synteny_no_chr)
str(new_karyotype)
str(synteny_no_chr)
table(synteny_no_chr$Species_2)
new_karyotype
head(synteny_no_chr)
head(new_synteny)
nrow(new_synteny)
new_synteny = tibble(new_synteny)
head(new_synteny)
ideogram(karyotype = new_karyotype,synteny = new_synteny)
new_synteny$Species_1 = as.character(new_synteny$Species_1)
new_synteny$Species_2 = as.character(new_synteny$Species_2)
head(new_synteny)
ideogram(karyotype = new_karyotype,synteny = new_synteny)
str(synteny_no_chr)
head(new_synteny)
str(new_synteny)
table(new_synteny$Species_1)
new_synteny_no_chr = new_synteny[new_synteny$Species_1 != 'X',]
new_synteny_no_chr = new_synteny[new_synteny$Species_1 != 'MT',]
head(new_synteny_no_chr)
table(new_synteny_no_chr$Species_1)
new_synteny_no_chr = new_synteny_no_chr[new_synteny_no_chr$Species_1 != 'X',]
table(new_synteny_no_chr$Species_1)
table(new_synteny_no_chr$Species_2)
new_synteny_no_chr$Species_1 = as.numeric(new_synteny_no_chr$Species_1)
new_synteny_no_chr$Species_2 = as.numeric(new_synteny_no_chr$Species_2)
ideogram(karyotype = new_karyotype,synteny = new_synteny)
new_synteny_no_chr
new_synteny_no_chr = new_synteny_no_chr[rowSums(is.na(new_synteny_no_chr)) == 0,]
head(new_synteny_no_chr)
nrow(new_synteny_no_chr)
ideogram(karyotype = new_karyotype,synteny = new_synteny_no_chr)
rowSums(is.na(new_synteny_no_chr))
new_synteny_no_chr[rowSums(is.na(new_synteny_no_chr)) == 1,]
new_karyotype
new_synteny_no_chr
is.na(new_synteny_no_chr)
new_synteny_no_chr[is.na(new_synteny_no_chr),]
new_synteny_no_chr[rowSums(is.na(new_synteny_no_chr)),]
new_synteny_no_chr[rowSums(is.na(new_synteny_no_chr)) > 0,]
str(new_synteny_no_chr)
ideogram(karyotype = new_karyotype,synteny = new_synteny_no_chr)
table(new_synteny_no_chr$Species_1)
table(new_synteny_no_chr$Species_2)
ncol(new_synteny_no_chr)
head(new_synteny_no_chr)
str(new_synteny_no_chr)
class(new_synteny_no_chr)
write.csv(new_synteny_no_chr,'syntheny.txt',row.names=FALSE)
synteny = read.table('syntheny.txt',sep=",",header=T,stringsAsFactors=F)
head(synteny)
ideogram(karyotype = new_karyotype,synteny = new_synteny_no_chr)
ideogram(karyotype = new_karyotype,synteny = synteny)
convertSVG("chromosome.svg", device = "png")
str(synteny)
head(synteny)
write.csv(new_karyotype,'karyotype_dual_comparison.txt',row.names=FALSE)
head(karyotype_dual_comparison)
table(synteny$Species_1,synteny$Species_2)
sort(table(synteny$Species_1,synteny$Species_2))
colSums(table(synteny$Species_1,synteny$Species_2))
table(synteny$Species_1,synteny$Species_2) / colSums(table(synteny$Species_1,synteny$Species_2))
table(synteny$Species_1,synteny$Species_2) / colSums(table(synteny$Species_1,synteny$Species_2)) * 100
table(synteny$Species_1,synteny$Species_2) / colSums(table(synteny$Species_1,synteny$Species_2)) * 100 > 40
head(synteny)
synteny[synteny$Species_2 == 2,"fill"] = '8acae7'
synteny[synteny$Species_2 == 3,"fill"] = '8b0a50'
synteny[synteny$Species_2 == 3,"fill"]
synteny[synteny$Species_2 == 5,"fill"] = '9400d3'
synteny[synteny$Species_2 == 9,"fill"] = '40000ff'
synteny[synteny$Species_2 == 13,"fill"] = 'ffc000'
synteny[synteny$Species_2 == 19,"fill"] = 'ff4000'
synteny[synteny$Species_2 == 20,"fill"] = 'a0bf97'
col_levels = c('8acae7','8b0a50','9400d3','40000ff','ffc000','ff4000','a0bf97','cccccc')
col_levels
sorted_synteny %>%
d;
sorted_synteny = synteny %>%
arrange(factor(fill,levels=col_levels))
head(sorted_synteny)
ideogram(karyotype = new_karyotype,synteny = sorted_synteny)
convertSVG("chromosome.svg", device = "png")
col_levels = c('cccccc','8acae7','8b0a50','9400d3','40000ff','ffc000','ff4000','a0bf97')
sorted_synteny = synteny %>%
arrange(factor(fill,levels=col_levels))
ideogram(karyotype = new_karyotype,synteny = sorted_synteny)
convertSVG("chromosome.svg", device = "png")
write.csv(sorted_synteny,'syntheny.txt',row.names=FALSE)
# read in tables
karyotype = read.table(
'karyotype_dual_comparison.txt',
sep=',',
header=T,
stringsAsFactors=F
)
synteny = read.table(
'syntheny.txt',
sep=',',
header=T,
stringsAsFactors=F
)
# generate graph
ideogram(karyotype = new_karyotype,synteny = sorted_synteny)
convertSVG("chromosome.svg", device = "png")
# generate graph
ideogram(
karyotype = karyotype,
synteny = synteny
)
convertSVG("chromosome.svg", device = "png")
load("C:/Users/james/OneDrive/Documents/BGMP/bi623/assignment_three/reciprococity/.RData")
git pull
setwd('..')
setwd('QAA')
setwd('C:/Users/james')
setwd("\\wsl$/Ubuntu/")
setwd("//wsl$/Ubuntu")
setwd("home/james/BGMP")
setwd("home")
setwd("BGMP/bi623/QAA")
setwd("james")
setwd("bioinformatics/bi623")
setwd("bioinformatics")
setwd("C:/Users/james/OneDrive/Documents")
setwd("BGMP")
setwd("bi623/qaa")
git pull
install.packages("tinytex")
tinytex::install_tinytex()
install.packages('formatR')
